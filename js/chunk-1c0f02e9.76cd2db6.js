(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c0f02e9"],{"1da1":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));n("d3b7");function r(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(u){return void n(u)}c.done?e(s):Promise.resolve(s).then(r,o)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(o,i){var a=t.apply(e,n);function c(t){r(a,o,i,c,s,"next",t)}function s(t){r(a,o,i,c,s,"throw",t)}c(void 0)}))}}},3213:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.topic?n("div",[n("Panel",{scopedSlots:t._u([{key:"header",fn:function(){return[n("span",[t._v("作者信息")])]},proxy:!0},{key:"content",fn:function(){return[n("div",{staticClass:"authorInfo"},[n("img",{attrs:{src:t.topic.author.avatar_url,alt:""}}),n("span",[t._v(t._s(t.topic.author.loginname))])])]},proxy:!0}],null,!1,1164340102)}),n("Panel",{scopedSlots:t._u([{key:"header",fn:function(){return[n("span",[t._v("文章详情")])]},proxy:!0},{key:"content",fn:function(){return[n("div",[n("div",{staticClass:"topic_header"},[n("div",{staticClass:"topic_header_title"},[t.topic.top||t.topic.good?n("span",{staticClass:"tab"},[t._v(t._s(t._f("getPostChineseTab")(t.topic)))]):t._e(),n("h2",[t._v(t._s(t.topic.title))])]),n("div",{staticClass:"changes"},[n("div",{staticClass:"changes_info"},[n("span",[t._v("发布于"+t._s(t._f("formatDateFromNow")(t.topic.create_at)))]),t._v(" "),n("span",[t._v("作者 "+t._s(t.topic.author.loginname))]),t._v(" "),n("span",[t._v(t._s(t.topic.visit_count)+"次浏览")]),t._v(" "),n("span",[t._v("最后一次编辑是 "+t._s(t._f("formatDateFromNow")(t.topic.last_reply_at)))]),t._v(" "),n("span",[t._v("来自 "+t._s(t.topic.tab))])]),n("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.collect}},[t._v(t._s(t.topic.is_collect?"取消收藏":"收藏"))])],1)]),n("hr"),n("div",{domProps:{innerHTML:t._s(t.topic.content)}})])]},proxy:!0}],null,!1,588208331)}),n("Panel",{scopedSlots:t._u([{key:"header",fn:function(){return[n("span",[t._v(t._s(t.topic.reply_count)+"回复")])]},proxy:!0},{key:"content",fn:function(){return[n("div",{staticClass:"replies"},t._l(t.topic.replies,(function(e){return n("div",{key:e.id,staticClass:"reply"},[n("div",{staticClass:"reply_author_info"},[n("el-avatar",{attrs:{shape:"square",size:32,src:e.author.avatar_url,title:e.author.loginname}}),n("span",{staticClass:"loginname"},[t._v(t._s(e.author.loginname))]),n("span",{staticClass:"create_at"},[t._v(t._s(t._f("formatDateFromNow")(e.create_at)))]),n("div",{staticClass:"btns"},[n("button",{class:e.is_uped?"up-active":"up-btn",on:{click:function(n){return t.upClick(e.id)}}},[t._v(" 喜欢"+t._s(e.ups.length)+" ")]),n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){return t.otherSubmit(e)}}},[t._v("回复")])],1)],1),n("div",[e.content?n("div",{domProps:{innerHTML:t._s(e.content)}}):n("div",[n("p",[t._v("暂无评论,请填加")])])]),e.id===t.reply_id?n("div",[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reply_text,expression:"reply_text"}],ref:"textarea",refInFor:!0,domProps:{value:t.reply_text},on:{input:function(e){e.target.composing||(t.reply_text=e.target.value)}}}),n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){return t.otherSubmit1(e.id)}}},[t._v("回复")])],1):t._e()])})),0),n("div",{staticClass:"topic-reply"},[n("Editor",{attrs:{"api-key":"9mieih2cqsubf30b1omff3w107ojvjfvzhmb7haq4giiy754",init:{language:"zh_CN",height:500,menubar:!0,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount"],toolbar:"code undo redo restoredraft | cut copy paste pastetext | forecolor backcolor bold italic underline strikethrough link anchor | alignleft aligncenter alignright alignjustify outdent indent |   styleselect formatselect fontselect fontsizeselect | bullist numlist | blockquote subscript superscript removeformat |   table image media charmap emoticons hr pagebreak insertdatetime print preview | fullscreen | bdmap indent2em lineheight formatpainter axupimgs"}},model:{value:t.text,callback:function(e){t.text="string"===typeof e?e.trim():e},expression:"text"}}),n("el-button",{staticClass:"up-btn",attrs:{type:"primary",size:"medium"},on:{click:t.submit}},[t._v("回复")])],1)]},proxy:!0}],null,!1,4049599094)})],1):t._e()},o=[],i=n("1da1"),a=(n("7db0"),n("96cf"),n("89d7")),c=n("ca72"),s={components:{Panel:a["a"],Editor:c["a"]},name:"Topic",data:function(){return{topic:null,text:"",reply_id:"",reply_text:""}},computed:{tab:function(){return this.$route.params.tab},token:function(){return this.$store.state.userInfo}},created:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,r,o,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.$route.params.topicId,r=localStorage.getItem("token"),o=r?"/topic/".concat(n,"?accesstoken=554fe09a-1ec6-492c-8fa9-ad376413dc43"):"/topic/".concat(n),e.next=5,t.$axios.get(o);case 5:i=e.sent,t.topic=i.data,a=i.data,t.$store.commit("getAuthorInfo",a),localStorage.setItem("authorInfo",a);case 10:case"end":return e.stop()}}),e)})))()},methods:{upClick:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$axios.post("/reply/".concat(t,"/ups"),{accesstoken:"554fe09a-1ec6-492c-8fa9-ad376413dc43"});case 2:r=n.sent,o=e.topic.replies.find((function(e){return e.id===t})),o.is_uped="up"===r.action,"up"===r.action?o.ups.push("608c07174d20cb811668fb16"):o.ups.pop();case 6:case"end":return n.stop()}}),n)})))()},submit:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.text,!n){e.next=8;break}return e.next=4,t.$axios.post("/topic/".concat(t.topic.id,"/replies"),{accesstoken:"554fe09a-1ec6-492c-8fa9-ad376413dc43",content:n});case 4:r=e.sent,o={id:r.reply_id,is_uped:!1,ups:[],content:n,author:{avatar_url:"https://avatars.githubusercontent.com/u/79734968?v=4&s=120",loginname:"BoZai-ya"}},t.topic.replies.unshift(o),t.text="";case 8:case"end":return e.stop()}}),e)})))()},otherSubmit:function(t){var e=t.id,n=t.author;this.reply_id=e,this.reply_text="@".concat(n.loginname,"  "),this.$nextTick((function(){console.log(this.$refs.textarea),this.$refs.textarea[0].focus()}))},otherSubmit1:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,o,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.reply_text,n.next=3,e.$axios.post("/topic/".concat(e.topic.id,"/replies"),{accesstoken:"554fe09a-1ec6-492c-8fa9-ad376413dc43",content:r,reply_id:t});case 3:o=n.sent,i={id:o.reply_id,is_uped:!1,ups:[],content:r,author:{avatar_url:"https://avatars.githubusercontent.com/u/79734968?v=4&s=120",loginname:"BoZai-ya"}},e.topic.replies.unshift(i),e.reply_text="",e.reply_id="";case 8:case"end":return n.stop()}}),n)})))()},collect:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,r,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.topic,r=n.is_collect,o=n.id,i=localStorage.getItem("token"),console.log(i),console.log(r),console.log(o),!r){e.next=11;break}return e.next=8,t.$axios.post("/topic_collect/de_collect",{topic_id:o,accesstoken:i});case 8:t.topic.is_collect=!1,e.next=14;break;case 11:return e.next=13,t.$axios.post("/topic_collect/collect",{topic_id:o,accesstoken:i});case 13:t.topic.is_collect=!0;case 14:case"end":return e.stop()}}),e)})))()}}},u=s,l=(n("c26e"),n("2877")),p=Object(l["a"])(u,r,o,!1,null,null,null);e["default"]=p.exports},"4caf":function(t,e,n){},"7db0":function(t,e,n){"use strict";var r=n("23e7"),o=n("b727").find,i=n("44d2"),a="find",c=!0;a in[]&&Array(1)[a]((function(){c=!1})),r({target:"Array",proto:!0,forced:c},{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i(a)},"96cf":function(t,e,n){var r=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,o="function"===typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(I){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof m?e:m,i=Object.create(o.prototype),a=new O(r||[]);return i._invoke=C(t,n,a),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(I){return{type:"throw",arg:I}}}t.wrap=u;var p="suspendedStart",f="suspendedYield",d="executing",h="completed",v={};function m(){}function y(){}function g(){}var _={};_[i]=function(){return this};var b=Object.getPrototypeOf,w=b&&b(b(j([])));w&&w!==n&&r.call(w,i)&&(_=w);var x=g.prototype=m.prototype=Object.create(_);function k(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function $(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,p=u.value;return p&&"object"===typeof p&&r.call(p,"__await")?e.resolve(p.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(p).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;function i(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}this._invoke=i}function C(t,e,n){var r=p;return function(o,i){if(r===d)throw new Error("Generator is already running");if(r===h){if("throw"===o)throw i;return P()}n.method=o,n.arg=i;while(1){var a=n.delegate;if(a){var c=S(a,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===p)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var s=l(t,e,n);if("normal"===s.type){if(r=n.done?h:f,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=h,n.method="throw",n.arg=s.arg)}}}function S(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator["return"]&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=l(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function j(t){if(t){var n=t[i];if(n)return n.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){while(++o<t.length)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:P}}function P(){return{value:e,done:!0}}return y.prototype=x.constructor=g,g.constructor=y,y.displayName=s(g,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},k($.prototype),$.prototype[a]=function(){return this},t.AsyncIterator=$,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new $(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},k(x),s(x,c,"Generator"),x[i]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){while(e.length){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=j,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),L(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;L(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:j(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=r}catch(o){Function("r","regeneratorRuntime = r")(r)}},c26e:function(t,e,n){"use strict";n("4caf")},c4a9:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return o}));var r=function(){return"undefined"!==typeof window?window:t},o=function(){var t=r();return t&&t.tinymce?t.tinymce:null}}).call(this,n("c8ba"))},ca72:function(t,e,n){"use strict";var r=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],o=function(t){return-1!==r.map((function(t){return t.toLowerCase()})).indexOf(t.toLowerCase())},i=function(t,e,n){Object.keys(e).filter(o).forEach((function(r){var o=e[r];"function"===typeof o&&("onInit"===r?o(t,n):n.on(r.substring(2),(function(t){return o(t,n)})))}))},a=function(t,e){var n=t.$props.modelEvents?t.$props.modelEvents:null,r=Array.isArray(n)?n.join(" "):n;e.on(r||"change input undo redo",(function(){t.$emit("input",e.getContent({format:t.$props.outputFormat}))}))},c=function(t,e,n){var r=e.$props.value?e.$props.value:"",o=e.$props.initialValue?e.$props.initialValue:"";n.setContent(r||(e.initialized?e.cache:o)),e.$watch("value",(function(t,r){n&&"string"===typeof t&&t!==r&&t!==n.getContent({format:e.$props.outputFormat})&&n.setContent(t)})),e.$listeners.input&&a(e,n),i(t,e.$listeners,n),e.initialized=!0},s=0,u=function(t){var e=Date.now(),n=Math.floor(1e9*Math.random());return s++,t+"_"+n+s+String(e)},l=function(t){return null!==t&&"textarea"===t.tagName.toLowerCase()},p=function(t){return"undefined"===typeof t||""===t?[]:Array.isArray(t)?t:t.split(" ")},f=function(t,e){return p(t).concat(p(e))},d=function(t){return null===t||void 0===t},h=function(){return{listeners:[],scriptId:u("tiny-script"),scriptLoaded:!1}},v=function(){var t=h(),e=function(t,e,n,r){var o=e.createElement("script");o.referrerPolicy="origin",o.type="application/javascript",o.id=t,o.src=n;var i=function(){o.removeEventListener("load",i),r()};o.addEventListener("load",i),e.head&&e.head.appendChild(o)},n=function(n,r,o){t.scriptLoaded?o():(t.listeners.push(o),n.getElementById(t.scriptId)||e(t.scriptId,n,r,(function(){t.listeners.forEach((function(t){return t()})),t.scriptLoaded=!0})))},r=function(){t=h()};return{load:n,reinitialize:r}},m=v(),y=n("c4a9"),g={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],value:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(t){return"html"===t||"text"===t}}},_=function(){return _=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},_.apply(this,arguments)},b=function(t,e,n){return t(n||"div",{attrs:{id:e}})},w=function(t,e){return t("textarea",{attrs:{id:e},style:{visibility:"hidden"}})},x=function(t){return function(){var e=_(_({},t.$props.init),{readonly:t.$props.disabled,selector:"#"+t.elementId,plugins:f(t.$props.init&&t.$props.init.plugins,t.$props.plugins),toolbar:t.$props.toolbar||t.$props.init&&t.$props.init.toolbar,inline:t.inlineEditor,setup:function(e){t.editor=e,e.on("init",(function(n){return c(n,t,e)})),t.$props.init&&"function"===typeof t.$props.init.setup&&t.$props.init.setup(e)}});l(t.element)&&(t.element.style.visibility="",t.element.style.display=""),Object(y["a"])().init(e)}},k={props:g,created:function(){this.elementId=this.$props.id||u("tiny-vue"),this.inlineEditor=this.$props.init&&this.$props.init.inline||this.$props.inline,this.initialized=!1},watch:{disabled:function(){this.editor.setMode(this.disabled?"readonly":"design")}},mounted:function(){if(this.element=this.$el,null!==Object(y["a"])())x(this)();else if(this.element&&this.element.ownerDocument){var t=this.$props.cloudChannel?this.$props.cloudChannel:"5",e=this.$props.apiKey?this.$props.apiKey:"no-api-key",n=d(this.$props.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+e+"/tinymce/"+t+"/tinymce.min.js":this.$props.tinymceScriptSrc;m.load(this.element.ownerDocument,n,x(this))}},beforeDestroy:function(){null!==Object(y["a"])()&&Object(y["a"])().remove(this.editor)},deactivated:function(){var t;this.inlineEditor||(this.cache=this.editor.getContent(),null===(t=Object(y["a"])())||void 0===t||t.remove(this.editor))},activated:function(){!this.inlineEditor&&this.initialized&&x(this)()},render:function(t){return this.inlineEditor?b(t,this.elementId,this.$props.tagName):w(t,this.elementId)}};e["a"]=k}}]);
//# sourceMappingURL=chunk-1c0f02e9.76cd2db6.js.map